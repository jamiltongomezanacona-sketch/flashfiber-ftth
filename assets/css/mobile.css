/* =====================================================
   FlashFiber FTTH - Mobile First Styles
   Estilos base para móvil (0px+) - Mobile First Approach
===================================================== */

/* ===============================
   Variables Responsive
=============================== */
:root {
  --touch-target-min: 44px;
  --touch-target-comfort: 48px;
  --spacing-mobile: 1rem;
  --spacing-tablet: 1.5rem;
  --spacing-desktop: 2rem;
}

/* ===============================
   Base Móvil - Touch Targets
=============================== */

/* Touch targets mínimos para botones e inputs */
button,
input[type="button"],
input[type="submit"],
a.button,
.menu-item {
  min-height: var(--touch-target-min);
  min-width: var(--touch-target-min);
  padding: 0.75rem 1rem;
}

/* Prevenir zoom accidental en iOS al enfocar inputs */
input,
select,
textarea {
  font-size: 16px; /* iOS no hace zoom si es 16px+ */
}

@media (min-width: 768px) {
  input,
  select,
  textarea {
    font-size: 14px; /* En desktop puede ser más pequeño */
  }
}

/* ===============================
   Scroll Mejorado iOS
=============================== */
.scrollable,
.panel-content,
.sidebar-menu,
#eventoModal .modal-content,
.route-card {
  -webkit-overflow-scrolling: touch;
  overflow-scrolling: touch;
}

/* ===============================
   Prevenir Selección Accidental
=============================== */
button,
.menu-item,
.map-controls button,
.route-btn,
#eventoModal .modal-footer button {
  -webkit-tap-highlight-color: rgba(0, 180, 216, 0.2);
  touch-action: manipulation; /* Previene double-tap zoom */
  user-select: none; /* Previene selección de texto accidental */
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

/* ===============================
   Viewport Fixes Móvil
=============================== */
@media (max-width: 767px) {
  /* Fix para iOS Safari - viewport height */
  body.app-map {
    height: 100svh;
    height: -webkit-fill-available; /* Fallback iOS */
  }
  
  /* Prevenir scroll horizontal */
  html, body {
    overflow-x: hidden;
    position: relative;
    width: 100%;
  }
}

/* ===============================
   Utilidades Responsive
=============================== */

/* Ocultar en móvil */
@media (max-width: 767px) {
  .hide-mobile {
    display: none !important;
  }
}

/* Mostrar solo en móvil */
.show-mobile {
  display: none;
}

@media (max-width: 767px) {
  .show-mobile {
    display: block;
  }
}

/* Ocultar en tablet y móvil */
@media (max-width: 1023px) {
  .hide-tablet {
    display: none !important;
  }
}

/* ===============================
   Espaciado Responsive
=============================== */
@media (max-width: 767px) {
  :root {
    --spacing-mobile: 0.75rem;
  }
}

@media (min-width: 768px) {
  :root {
    --spacing-mobile: 1rem;
  }
}

@media (min-width: 1024px) {
  :root {
    --spacing-mobile: 1.5rem;
  }
}

/* ===============================
   Optimizaciones de Rendimiento
=============================== */

/* Reducir repaints en elementos animados */
.sidebar,
.sidebar-overlay,
.route-card,
#eventoModal .modal-content {
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Optimizar scroll en móvil */
@media (max-width: 767px) {
  .sidebar,
  #eventoModal .modal-content,
  .route-card {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain; /* Previene scroll bounce */
  }
}

/* Mejorar rendimiento de backdrop-filter */
.sidebar,
#btnSidebar,
.map-controls button {
  transform: translateZ(0); /* Acelera hardware */
}

/* ===============================
   Popup propiedades del pin (móvil)
   Versátil y elegante en celular
=============================== */

@media (max-width: 767px) {
  .mapboxgl-popup-content {
    min-width: 0 !important;
    max-width: min(280px, calc(100vw - 32px)) !important;
    width: auto !important;
    max-height: 85vh !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    border-radius: 18px !important;
    box-shadow:
      0 20px 40px -12px rgba(0, 0, 0, 0.5),
      0 0 0 1px rgba(255, 255, 255, 0.06),
      0 0 0 1px rgba(0, 229, 255, 0.08) !important;
    font-size: 13px !important;
  }

  .pin-popup-card {
    min-width: 0;
  }

  .pin-popup-header {
    padding: 12px 14px 10px;
    gap: 10px;
  }

  .pin-popup-header-icon {
    width: 38px;
    height: 38px;
    font-size: 18px;
    border-radius: 10px;
  }

  .pin-popup-title {
    font-size: 14px;
    font-weight: 600;
    line-height: 1.25;
    flex: 1;
    min-width: 0;
    word-break: break-word;
    text-transform: capitalize;
    letter-spacing: -0.02em;
  }

  .pin-popup-body {
    padding: 10px 14px 12px;
    max-height: 35vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }

  .pin-popup-row {
    flex-direction: column;
    gap: 2px;
    padding: 7px 0;
    font-size: 12px;
    align-items: flex-start;
  }

  .pin-popup-label {
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 0.04em;
    color: rgba(255, 255, 255, 0.5);
  }

  .pin-popup-value {
    text-align: left;
    font-size: 12px;
    color: #e2e8f0;
    line-height: 1.4;
  }

  .pin-popup-actions {
    flex-direction: row;
    gap: 8px;
    padding: 10px 14px 12px;
  }

  .pin-popup-btn {
    min-height: 38px;
    padding: 7px 11px;
    font-size: 11px;
    border-radius: 8px;
    font-weight: 600;
  }

  .mapboxgl-popup-close-button {
    width: 36px !important;
    height: 36px !important;
    font-size: 18px !important;
    padding: 0 !important;
    line-height: 36px !important;
    color: rgba(255, 255, 255, 0.85) !important;
    right: 4px !important;
    top: 4px !important;
  }
}

/* Tablet: popup un poco más ancho pero sin ocupar toda la pantalla */
@media (min-width: 768px) and (max-width: 1023px) {
  .mapboxgl-popup-content {
    max-width: 360px !important;
    border-radius: 18px !important;
  }

  .pin-popup-btn {
    min-height: 44px;
    padding: 12px 16px;
  }
}
